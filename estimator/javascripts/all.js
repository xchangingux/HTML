!function e(t,n,i){function a(s,o){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!o&&c)return c(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return a(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t){var n;n={NAME:""},t.exports=n},{}],2:[function(e,t){var n;n={getUrlParameter:function(e){var t,n,i,a;for(n=window.location.search.substring(1),a=n.split("&"),t=0;t<a.length;){if(i=a[t].split("="),i[0]===e)return i[1];t++}}},t.exports=n},{}],3:[function(e,t){var n,i;i=e("../models/PricingMapModel.coffee"),n=Backbone.Collection.extend({model:i,initialize:function(e,t){return window.currentDatacenter=t.datacenter,this.url="json/pricing/"+t.datacenter+".json",this.fetch()},forKey:function(e){return _.first(this.where({type:e}))}}),t.exports=n},{"../models/PricingMapModel.coffee":6}],4:[function(e,t){var n,i;n=e("../models/ServerModel.coffee"),i=Backbone.Collection.extend({model:n,subtotal:function(){return _.reduce(this.models,function(e,t){return e+t.totalPricePerMonth()+t.managedAppsPricePerMonth()},0)},oSSubtotal:function(){return _.reduce(this.models,function(e,t){return e+t.totalOSPricePerMonth()},0)},initPricing:function(e){return this.each(function(){return function(t){var n;return n=e.forKey("server"),t.updatePricing(n)}}(this))}}),t.exports=i},{"../models/ServerModel.coffee":7}],5:[function(e,t){var n,i;n=e("../models/ServiceModel.coffee"),i=Backbone.Collection.extend({model:n,url:function(){return this.options.collectionUrl},initialize:function(e){return this.options=e||{},this.fetch()},initPricing:function(e){return this.each(function(){return function(t){var n;return n=e.forKey(t.get("key")),t.initPricing(n)}}(this))},subtotal:function(){return _.reduce(this.models,function(e,t){return e+t.totalPricePerMonth()},0)}}),t.exports=i},{"../models/ServiceModel.coffee":8}],6:[function(e,t){var n;n=Backbone.Model.extend({initialize:function(){}}),t.exports=n},{}],7:[function(e,t){var n;n=Backbone.Model.extend({HOURS_PER_DAY:"hours_per_day",HOURS_PER_WEEK:"hours_per_week",HOURS_PER_MONTH:"hours_per_month",PERCENTAGE_OF_MONTH:"percentage_of_month",HOURS_IN_MONTH:730,DAYS_IN_MONTH:30.41666667,WEEKS_IN_MONTH:4.345238095,defaults:{type:"standard",os:"linux",cpu:1,memory:1,storage:1,quantity:1,usagePeriod:"percentage_of_month",usage:100,managed:!1,managedApps:[]},initialize:function(){return this.initPricing(),this.set("managedApps",[])},initPricing:function(){var e;return e=this.get("pricingMap").attributes.options,this.set("pricing",e)},updatePricing:function(e){return this.set("pricing",e.attributes.options)},totalCpuPerHour:function(){return this.get("cpu")*this.get("pricing").cpu},totalMemoryPerHour:function(){return this.get("memory")*this.get("pricing").memory},totalOSPerHour:function(){var e;return e=this.get("os"),this.get("pricing").os[e]*this.get("cpu")},managedBasePricePerHour:function(){var e,t;return this.get("managed")?(e=this.get("os"),t=this.get("pricing").os[""+e+"-managed"]):0},utilityPricePerHourPerInstance:function(){return this.totalCpuPerHour()+this.totalMemoryPerHour()+this.totalOSPerHour()+this.managedBasePricePerHour()},utilityPricePerHourTotal:function(){return this.utilityPricePerHourPerInstance()*this.get("quantity")},storagePricePerMonth:function(){var e;return e=this.get("type"),this.get("storage")*this.get("pricing").storage[e]*this.get("quantity")},managedAppPricePerMonth:function(e,t){var n;return n=this.get("pricing")[e],this.priceForMonth(n)*this.get("quantity")*t},managedAppsPricePerMonth:function(){var e,t;return e=this.get("managedApps"),t=0,_.each(e,function(e){return function(n){return t+=e.managedAppPricePerMonth(n.key,n.instances)}}(this)),t},totalOSPricePerMonth:function(){return this.priceForMonth(this.totalOSPerHour())*this.get("quantity")},totalPricePerMonth:function(){var e;return e=0,e=this.priceForMonth(this.utilityPricePerHourTotal()),e+this.storagePricePerMonth()},totalPricePerMonthWithApps:function(){return this.totalPricePerMonth+this.managedAppsPricePerMonth()},priceForMonth:function(e){switch(this.get("usagePeriod")){case this.HOURS_PER_DAY:return e*this.get("usage")*this.DAYS_IN_MONTH;case this.HOURS_PER_WEEK:return e*this.get("usage")*this.WEEKS_IN_MONTH;case this.HOURS_PER_MONTH:return e*this.get("usage");case this.PERCENTAGE_OF_MONTH:return this.get("usage")/100*this.HOURS_IN_MONTH*e}},addManagedApp:function(e,t){var n;return n=this.get("managedApps"),n.push({key:e,name:t,instances:1}),this.set("managedApps",n),this.trigger("change",this),this.trigger("change:managedApps",this)},updateManagedAppIntances:function(e,t){var n;return n=this.get("managedApps"),_.each(n,function(n){return n.key===e?n.instances=t:void 0}),this.set("managedApps",n),this.trigger("change:managedApps",this)}}),t.exports=n},{}],8:[function(e,t){var n;n=Backbone.Model.extend({defaults:{title:"",description:"",input:"select",quantity:0,disabled:!1},initPricing:function(e){return this.set("pricing",e.get("price")),this.set("disabled",e.get("disabled"))},totalPricePerMonth:function(){return this.get("pricing")*this.get("quantity")}}),t.exports=n},{}],9:[function(e,t){t.exports=function(e){return function(){var e,t,n;return t=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\//g,"&#47;").replace(/"/g,"&quot;")},e=function(e){switch(e){case null:case void 0:return"";case!0:case!1:return"\x93"+e;default:return e}},n=[],n.push("<td class='add-managed-app-cell table-cell' colspan='"+t(e(this.colspan))+"'>\n  <div class='add-managed-button'>\n    <span class='plus'></span>\n    managed application \n    <span class='down-arrow'></span>\n    <div class='managed-app-options'>\n      <a class='redhat-app' href='#' data-key='apache' data-name='Apache HTTP Server'>Apache HTTP Server</a>\n      <a class='redhat-app' href='#' data-key='cloudera-cdh5-basic' data-name='Cloudera CDH5 Basic'>Cloudera CDH5 Basic</a>\n      <a class='redhat-app' href='#' data-key='cloudera-cdh5-basic-hbase' data-name='Cloudera CDH5 Basic + HBase'>Cloudera CDH5 Basic + HBase</a>\n      <a class='redhat-app' href='#' data-key='cloudera-enterprise-data-hub' data-name='Cloudera Enterprise Data Hub'>Cloudera Enterprise Data Hub</a>\n      <a class='redhat-app' href='#' data-key='mysql' data-name='MySQL'>MySQL</a>\n      <a class='redhat-app' href='#' data-key='mysql-replication-master-master' data-name='MySQL Replication (Master/Master)'>MySQL Replication (Master/Master)</a>\n      <a class='redhat-app' href='#' data-key='mysql-replication-master-slave' data-name='MySQL Replication (Master/Slave)'>MySQL Replication (Master/Slave)</a>\n      <a class='redhat-app' href='#' data-key='tomcat' data-name='Tomcat'>Tomcat</a>\n      <a class='windows-app' href='#' data-key='active-directory' data-name='Active Directory'>Active Directory</a>\n      <a class='windows-app' href='#' data-key='ms-sql' data-name='MS SQL'>MS SQL</a>\n      <a class='windows-app' href='#' data-key='iis' data-name='MS IIS'>MS IIS</a>\n      <!-- %a{:href => \"#\", data: {key: \"ssl\", name: \"GeoTrust Quick SSL Certificate\"}} GeoTrust Quick SSL Certificate -->\n    </div>\n  </div>\n</td>"),n.join("\n").replace(/\s(\w+)='\x93true'/gm," $1").replace(/\s(\w+)='\x93false'/gm,"").replace(/\s(?:id|class)=(['"])(\1)/gm,"")}.call(e)}},{}],10:[function(e,t){t.exports=function(e){return function(){var e,t,n;return t=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\//g,"&#47;").replace(/"/g,"&quot;")},e=function(e){switch(e){case null:case void 0:return"";case!0:case!1:return"\x93"+e;default:return e}},n=[],n.push("<td class='managed-app-quantity-cell table-cell' colspan='1'>\n  <span class='managed-app-quantity'></span>\n  <td class='managed-app-usage-cell table-cell' colspan='2'>"),n.push("mysql"===this.app.key||"ms-sql"===this.app.key?"    x\n    <input class='number' name='usage' value='"+t(e(1))+"' type='text'>\n    instance(s) / server":"    &nbsp;"),n.push("  </td>\n</td>\n<td class='managed-app-cell table-cell' colspan='"+t(e(this.colspan))+"'>\n  Managed "+this.app.name+"\n</td>\n<td class='price-cell table-cell' colspan='1'>\n  <span class='price'></span>\n  <a class='remove-button' href='#' data-key='"+t(e(this.app.key))+"'>X</a>\n</td>"),n.join("\n").replace(/\s(\w+)='\x93true'/gm," $1").replace(/\s(\w+)='\x93false'/gm,"").replace(/\s(?:id|class)=(['"])(\1)/gm,"")}.call(e)}},{}],11:[function(e,t){t.exports=function(e){return function(){var e,t,n;return t=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\//g,"&#47;").replace(/"/g,"&quot;")},e=function(e){switch(e){case null:case void 0:return"";case!0:case!1:return"\x93"+e;default:return e}},n=[],n.push("<td class='quantity-cell table-cell'>\n  <input class='number' name='quantity' value='"+t(e(this.model.get("quantity")))+"' type='text'>\n</td>\n<td class='table-cell usage-cell'>\n  <input class='number' name='usage' value='"+t(e(this.model.get("usage")))+"' type='text'>\n  <select name='usagePeriod'>\n    <option value='hours_per_month' selected='"+t(e("hours_per_month"===this.model.get("usagePeriod")))+"'>hrs / month</option>\n    <option value='percentage_of_month' selected='"+t(e("percentage_of_month"===this.model.get("usagePeriod")))+"'>% / month</option>\n    <option value='hours_per_week' selected='"+t(e("hours_per_week"===this.model.get("usagePeriod")))+"'>hrs / week</option>\n    <option value='hours_per_day' selected='"+t(e("hours_per_day"===this.model.get("usagePeriod")))+"'>hrs / day</option>\n  </select>\n</td>"),n.push("hyperscale"===this.model.get("type")?"<input type='hidden' value='hyperscale'>":"<td class='table-cell type-cell'>\n  <select name='type'>\n    <option value='standard' selected='"+t(e("standard"===this.model.get("type")))+"'>standard</option>\n    <option value='premium' selected='"+t(e("premium"===this.model.get("type")))+"'>premium</option>\n  </select>\n</td>"),n.push("<td class='os-cell table-cell'>\n  <select name='os'>\n    <option value='linux' selected='"+t(e("linux"===this.model.get("os")))+"'>Linux</option>\n    <option value='redhat' selected='"+t(e("redhat"===this.model.get("os")))+"'>Red Hat</option>\n    <option value='windows' selected='"+t(e("windows"===this.model.get("os")))+"'>Windows</option>\n  </select>\n</td>\n<td class='"+["table-cell","managed-cell",""+t(e(this.disabledClass))].sort().join(" ").replace(/^\s+|\s+$/g,"")+"'>\n  <input class='managed-check' type='checkbox' name='managed'>\n</td>\n<td class='cpu-cell range-cell table-cell'>\n  <input class='cpu-text-input' data-name='cpu'>\n  <input class='range-slider' name='cpu' type='range' min='"+t(e(1))+"' max='"+t(e(16))+"' value='"+t(e(this.model.get("cpu")))+"'>\n</td>\n<td class='memory-cell range-cell table-cell'>\n  <input class='memory-text-input' data-name='memory'>\n  <input class='range-slider' name='memory' type='range' min='"+t(e(1))+"' max='"+t(e(128))+"' value='"+t(e(this.model.get("memory")))+"'>\n</td>\n<td class='range-cell storage-cell table-cell'>\n  <input class='storage-text-input' data-name='storage'>"),n.push("hyperscale"===this.model.get("type")?"  <input class='range-slider' name='storage' type='range' min='"+t(e(1))+"' max='"+t(e(1024))+"' step='"+t(e(1))+"' value='"+t(e(this.model.get("storage")))+"'>":"  <input class='range-slider' name='storage' type='range' min='"+t(e(1))+"' max='"+t(e(4e3))+"' step='"+t(e(1))+"' value='"+t(e(this.model.get("storage")))+"'>"),n.push("</td>\n<td class='price-cell table-cell'>\n  <span class='price'>"),n.push("    "+t(e(accounting.formatMoney(this.model.totalPricePerMonth())))),n.push("  </span>\n  <a class='remove-button' href='#'>X</a>\n</td>"),n.join("\n").replace(/\s(\w+)='\x93true'/gm," $1").replace(/\s(\w+)='\x93false'/gm,"").replace(/\s(?:id|class)=(['"])(\1)/gm,"")}.call(e)}},{}],12:[function(e,t){t.exports=function(e){return function(){var e,t,n;return t=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/\//g,"&#47;").replace(/"/g,"&quot;")},e=function(e){switch(e){case null:case void 0:return"";case!0:case!1:return"\x93"+e;default:return e}},n=[],n.push("<form>\n  <div class='service__info'>\n    <h4>"+t(e(this.model.get("title")))+"</h4>"),this.model.get("description")&&(n.push("    <div class='service__description'>\n      <p>"),n.push("        "+t(e(this.model.get("description")))),this.model.get("link")&&n.push("        <br>\n        <a href='"+t(e(this.model.get("link")))+"' target='_blank'>more info</a>"),n.push("      </p>\n    </div>")),n.push("  </div>\n  <div class='"+["service__inputs",""+t(e(this.model.get("input")))].sort().join(" ").replace(/^\s+|\s+$/g,"")+"'>"),"slider"===this.model.get("input")?(n.push("    <div class='quantity-wrapper'>\n      <span class='quantity'>"),n.push("        "+t(e(this.model.get("quantity")))),n.push("      </span>\n      GB\n    </div>\n    <input class='range-slider' type='range' name='quantity' min='"+t(e(0))+"' max='"+t(e(1e4))+"' value='"+t(e(this.model.get("quantity")))+"'>")):(n.push("    <span class='select'></span>\n    QTY\n      <select name='quantity'>\n        <option>0</option>\n        <option>1</option>\n        <option>2</option>\n        <option>3</option>\n        <option>4</option>\n        <option>5</option>\n      </select>\n      x\n      <span class='cost'>"),n.push("        "+t(e(accounting.formatMoney(this.model.get("pricing"))))),n.push("      </span>")),n.push("    <span class='price'>"),n.push("      "+t(e(accounting.formatMoney(this.model.totalPricePerMonth)))),n.push("    </span>\n  </div>\n</form>"),n.join("\n").replace(/\s(\w+)='\x93true'/gm," $1").replace(/\s(\w+)='\x93false'/gm,"").replace(/\s(?:id|class)=(['"])(\1)/gm,"")}.call(e)}},{}],13:[function(e,t){var n;n=Backbone.View.extend({tagName:"tr",className:"table-row add-managed-app-row is-managed",render:function(){var t,n;return n=e("../templates/addManagedApp.haml"),t="hyperscale"===this.model.get("type")?8:9,this.$el.html(n({os:this.model.get("os"),colspan:t})),this.$el.addClass("managed-app-add-button-for-server_"+this.model.cid),this.updateOptions(),this},events:function(){return{"click a":"addManagedApp"}},addManagedApp:function(e){var t,n;return e.preventDefault(),t=$(e.currentTarget).data("key"),n=$(e.currentTarget).data("name"),this.model.addManagedApp(t,n)},updateOptions:function(){return"windows"===this.model.get("os")?($(".redhat-app",this.$el).hide(),$(".windows-app",this.$el).css("display","block")):($(".redhat-app",this.$el).css("display","block"),$(".windows-app",this.$el).hide())}}),t.exports=n},{"../templates/addManagedApp.haml":9}],14:[function(e,t){var n;n=Backbone.View.extend({tagName:"tr",className:"table-row managed-app-row is-managed",events:function(){return{"click .remove-button":"onRemoveClick","change input":"onFormChanged","input input":"onFormChanged","keyup input":"onFormChanged","keypress input":"ensureNumber"}},initialize:function(e){return this.options=e||{}},render:function(){var t,n;return n=e("../templates/managedApp.haml"),t="hyperscale"===this.model.get("type")?4:5,this.$el.html(n({app:this.options.app,colspan:t})),this.$el.addClass("managed-row-for-server_"+this.model.cid),this.updateQuantityAndPrice(),this},onRemoveClick:function(e){var t,n;return e.preventDefault(),n=$(e.currentTarget).data("key"),t=this.model.get("managedApps"),t=_.reject(t,function(e){return e.key===n}),this.model.set("managedApps",t)},updateQuantityAndPrice:function(){var e,t,n;return n=this.model.get("quantity"),t=this.model.managedAppPricePerMonth(this.options.app.key,this.options.app.instances),e=this.options.app.instances||1,$(".managed-app-quantity",this.$el).html(n),$(".price",this.$el).html(accounting.formatMoney(t)),$("input[name=usage]",this.$el).val(e)},onFormChanged:function(){var e;return e=$("input[name=usage]",this.$el).val(),this.model.updateManagedAppIntances(this.options.app.key,e)},ensureNumber:function(e){var t;return t=e.which?e.which:e.keyCode,!(t>31&&(48>t||t>57))}}),t.exports=n},{"../templates/managedApp.haml":10}],15:[function(e,t){var n;n=Backbone.View.extend({el:"#monthly-total",events:{"change .datacenter":"changeDatacenter"},initialize:function(e){return this.options=e||{},this.options.app.on("totalPriceUpdated",function(e){return function(){return e.updateTotal()}}(this)),$.getJSON("json/pricing/index.json",function(t){return function(n){return $.each(n,function(n,i){var a,r;return a=i[1].replace("_"," "),r=e.datacenter===i[0]?"selected":"",$(".datacenter",t.$el).append("<option value='"+i[0]+"' "+r+">"+a+"</option>")})}}(this)),$(window).scroll(function(e){return function(){return e.positionHeader()}}(this))},updateTotal:function(){return $(".price",this.$el).html(accounting.formatMoney(this.options.app.totalPriceWithSupport))},positionHeader:function(){return $(window).scrollTop()>289?this.$el.css("position","fixed"):this.$el.css("position","absolute")},changeDatacenter:function(e){var t;return t=window.top.location.href,t=t.replace(/\?datacenter=.*/,""),t=""+t+"?datacenter="+$(e.target).val(),window.top.location.href=t}}),t.exports=n},{}],16:[function(e,t){var n,i,a;n=e("./AddManagedAppView.coffee"),i=e("./ManagedAppView.coffee"),a=Backbone.View.extend({tagName:"tr",className:"table-row",events:{"keypress .number":"ensureNumber","click .remove-button":"removeServer","click .managed-check":"onManagedCheckboxChanged","change select[name]":"onFormChanged","change input[name]":"onFormChanged","input input[name]":"onFormChanged","keyup input[name]":"onFormChanged","keypress input:not([name])":"ensureNumber","input input:not([name])":"onSliderTextChanged"},initialize:function(){return this.appViews=[],this.listenTo(this.model,"change",function(e){return function(t){return e.onModelChange(t)}}(this)),this.listenTo(this.model,"change:managedApps",function(e){return function(t){return e.onManagedChanged(t)}}(this))},render:function(){var t,n,i;return i=e("../templates/server.haml"),n="disabled"===this.model.get("pricingMap").get("options").os["redhat-managed"],t="",n&&(t="disabled"),this.$el.html(i({model:this.model,disabledClass:t})),this.$el.attr("id",this.model.cid),_.defer(function(e){return function(){return $(".range-slider",e.$el).rangeslider({polyfill:!1}),$(".range-slider",e.$el).css("opacity",1)}}(this)),this},close:function(){return this.remove(),this.unbind(),this.addManagedAppView&&this.addManagedAppView.remove(),this.removeAllManagedApps()},removeServer:function(e){return e.preventDefault(),this.model.destroy()},ensureNumber:function(e){var t;return t=e.which?e.which:e.keyCode,!(t>31&&(48>t||t>57))},onSliderTextChanged:function(e){var t,n,i,a;return t=$(e.currentTarget),i=t.data("name"),a=t.val(),""!==a?(n=Backbone.Syphon.serialize(this),n.storage=a,this.model.set(n),$("[name="+i+"]",this.$el).val(a).change()):void 0},onFormChanged:function(e){var t;return e.preventDefault(),t=Backbone.Syphon.serialize(this),this.model.set(t)},onManagedCheckboxChanged:function(e){var t;return t=$(e.currentTarget),t.is(":checked")?this.addMangedApps():this.removeAllManagedAppsAndAddButton()},addMangedApps:function(){return this.addManagedAppView=new n({model:this.model}),this.$el.after(this.addManagedAppView.render().el)},removeAllManagedApps:function(){return _.each(this.appViews,function(e){return e.remove()}),this.appViews=[]},removeAllManagedAppsAndAddButton:function(){return this.$el.removeClass("is-managed"),this.model.set("managedApps",[]),this.addManagedAppView&&this.addManagedAppView.remove(),this.removeAllManagedApps()},onManagedChanged:function(e){var t;return this.removeAllManagedApps(),t=e.get("managedApps"),_.each(t,function(t){return function(n){var a;return a=new i({model:e,app:n}),t.appViews.push(a),t.addManagedAppView.$el.before(a.render().el)}}(this))},onModelChange:function(e){return $(".price",this.$el).html(accounting.formatMoney(e.totalPricePerMonth())),$(".cpu",this.$el).html(e.get("cpu")),$(".memory",this.$el).html(e.get("memory")),$(".storage",this.$el).html(e.get("storage")),$(".storage-text-input",this.$el).val(e.get("storage")),$(".cpu-text-input",this.$el).val(e.get("cpu")),$(".memory-text-input",this.$el).val(e.get("memory")),"linux"===e.get("os")?(e.set("managed",!1),$(".managed-check",this.$el).attr("disabled",!0),$(".managed-check",this.$el).attr("checked",!1),this.removeAllManagedAppsAndAddButton()):$(".managed-check",this.$el).attr("disabled",!1),_.each(this.appViews,function(){return function(e){return e.updateQuantityAndPrice()}}(this)),this.addManagedAppView?this.addManagedAppView.updateOptions():void 0}}),t.exports=a},{"../templates/server.haml":11,"./AddManagedAppView.coffee":13,"./ManagedAppView.coffee":14}],17:[function(e,t){var n,i,a;i=e("./ServerView.coffee"),n=e("../models/ServerModel.coffee"),a=Backbone.View.extend({events:{"click .add-button":"addServer"},initialize:function(e){return this.options=e||{},this.collection.on("add",function(e){return function(t){return e.onServerAdded(t)}}(this)),this.collection.on("remove",function(e){return function(t){return e.onServerRemoved(t)}}(this)),this.collection.on("change",function(e){return function(){return e.updateSubtotal()}}(this)),this.updateSubtotal(),this.serverViews=[],this.options.hyperscale&&"disabled"===this.options.pricingMap.get("options").storage.hyperscale&&this.$el.addClass("disabled"),$(".has-tooltip",this.$el).tooltip()},addServer:function(e){var t;return e&&e.preventDefault(),t=this.options.hyperscale===!0?"hyperscale":"standard",this.collection.add({pricingMap:this.options.pricingMap,type:t})},onServerAdded:function(e){var t;return t=new i({model:e}),this.serverViews[e.cid]=t,$(".table",this.$el).append(t.render().el),this.updateSubtotal()},onServerRemoved:function(e){return this.serverViews[e.cid].close(),this.updateSubtotal()},updateSubtotal:function(){return $(".subtotal",this.$el).html(accounting.formatMoney(this.collection.subtotal()))}}),t.exports=a},{"../models/ServerModel.coffee":7,"./ServerView.coffee":16}],18:[function(e,t){var n;n=Backbone.View.extend({className:"service",events:{"change select":"onFormChanged","change input":"onFormChanged","input input":"onFormChanged"},initialize:function(e){return this.options=e||{},this.model.on("change",function(e){return function(t){return e.onModelChange(t)}}(this))},render:function(){var t;return t=e("../templates/service.haml"),this.$el.html(t({model:this.model})),this.$el.attr("id",this.model.cid),this.$el.addClass(this.model.get("key")),this.options.disabled&&this.$el.addClass("disabled"),_.defer(function(e){return function(){return $(".range-slider",e.$el).rangeslider({polyfill:!1}),$(".range-slider",e.$el).css("opacity",1)}}(this)),this},onFormChanged:function(e){var t;return e.preventDefault(),t=Backbone.Syphon.serialize(this),this.model.set(t)},onModelChange:function(e){return $(".cost",this.$el).html(accounting.formatMoney(e.get("pricing"))),$(".price",this.$el).html(accounting.formatMoney(e.totalPricePerMonth())),$(".quantity",this.$el).html(e.get("quantity")),e.get("quantity")>0?this.$el.addClass("active"):this.$el.removeClass("active")}}),t.exports=n},{"../templates/service.haml":12}],19:[function(e,t){var n,i,a;i=e("./ServiceView.coffee"),n=e("../models/ServiceModel.coffee"),a=Backbone.View.extend({initialize:function(e){return this.options=e||{},this.collection.on("reset",function(e){return function(){return e.$el.html(""),e.addServices()}}(this)),this.collection.on("change",function(e){return function(){return e.updateSubtotal()}}(this)),this.addServices(),this.updateSubtotal()},addServices:function(){return this.collection.each(function(e){return function(t){var n,a;return n=t.get("disabled"),a=new i({model:t,disabled:n}),$(".services",e.$el).append(a.render().el)}}(this))},updateSubtotal:function(){return $(".subtotal",this.$el).html(accounting.formatMoney(this.collection.subtotal()))}}),t.exports=a},{"../models/ServiceModel.coffee":8,"./ServiceView.coffee":18}],20:[function(e,t){var n;n=Backbone.View.extend({el:"#support",events:{"click .support-select":"onSupportSelectClick","click .support-select a":"onSupportSelectInnerLinkClick"},initialize:function(e){return this.options=e||{},this.selectPlan("developer")},onSupportSelectClick:function(e){var t,n;return e.preventDefault(),e.stopPropagation(),t=$(e.currentTarget),n=t.data("plan"),this.selectPlan(n),this.options.app.updateTotalPrice()},onSupportSelectInnerLinkClick:function(e){return e.stopPropagation()},selectPlan:function(e){return this.currentPlan=e,$(".support-select").removeClass("selected"),$(".support-select .status-label").html("Select"),$(".support-select[data-plan="+e+"]").addClass("selected"),$(".support-select[data-plan="+e+"] .status-label").html("Selected"),this.updateSubtotal()},calculateSupportBill:function(){var e,t,n,i,a;return"developer"===this.currentPlan?0:(e=this.options.app.totalPrice-this.options.app.oSSubtotal||0,i=[1e4,8e4,25e4,1e6],n=[.1,.07,.05,.03],t=_.map(i,function(t,a){var r;return r=i[a-1]||null,0===a&&t>e?[e,n[a]]:r>e?null:t>e?[e-r,n[a]]:[t-r,n[a]]}),a=0,_.map(t,function(e){return e?a+=e[0]*e[1]:void 0}),a)},updateSubtotal:function(){return this.supportPrice=this.calculateSupportBill(),$(".subtotal",this.$el).html(accounting.formatMoney(this.supportPrice)),this.supportPrice}}),t.exports=n},{}],21:[function(e){var t,n,i,a,r,s,o,c,l,p,u;n=e("./app/Config.coffee"),s=e("./app/views/ServersView.coffee"),p=e("./app/views/SupportView.coffee"),l=e("./app/views/ServicesView.coffee"),i=e("./app/views/MonthlyTotalView.coffee"),a=e("./app/collections/PricingMapsCollection.coffee"),r=e("./app/collections/ServersCollection.coffee"),c=e("./app/collections/ServicesCollection.coffee"),o=e("./app/models/ServiceModel.coffee"),u=e("./app/Utils.coffee"),t={initialized:!1,init:function(){var e,t;return _.extend(this,Backbone.Events),e=u.getUrlParameter("datacenter"),t=e||"NY1",this.monthlyTotalView=new i({app:this,datacenter:t}),this.supportView=new p({app:this}),this.pricingMaps=new a([],{datacenter:t}),this.pricingMaps.on("sync",function(e){return function(){return e.onPricingMapsSynced()}}(this))},onPricingMapsSynced:function(){return this.initServers(),this.initHyperscaleServers(),this.networkingServices=new c({collectionUrl:"json/networking-services.json"}),this.additionalServices=new c({collectionUrl:"json/additional-services.json"}),this.bandwidthServices=new c({collectionUrl:"json/bandwidth.json"}),this.networkingServices.on("sync",function(e){return function(){return e.initNetworkServices()}}(this)),this.additionalServices.on("sync",function(e){return function(){return e.initAdditionalServices()}}(this)),this.bandwidthServices.on("sync",function(e){return function(){return e.initBandwidthServices()}}(this))},initNetworkServices:function(){return this.networkingServices.initPricing(this.pricingMaps),this.networkingServicesView=new l({collection:this.networkingServices,el:"#networking-services"}),this.networkingServices.on("change",function(e){return function(){return e.updateTotalPrice()}}(this)),this.initialized=!0,this.updateTotalPrice()},initAdditionalServices:function(){return this.additionalServices.initPricing(this.pricingMaps),this.additionalServicesView=new l({collection:this.additionalServices,el:"#additional-services"}),this.additionalServices.on("change",function(e){return function(){return e.updateTotalPrice()}}(this)),this.initialized=!0,this.updateTotalPrice(),$(".main-container").addClass("visible"),$(".spinner").hide()},initBandwidthServices:function(){return this.bandwidthServices.initPricing(this.pricingMaps),this.bandwidthServicesView=new l({collection:this.bandwidthServices,el:"#bandwidth"}),this.bandwidthServices.on("change",function(e){return function(){return e.updateTotalPrice()}}(this)),this.initialized=!0,this.updateTotalPrice()},initServers:function(){return this.serversCollection=new r,this.serversCollection.on("change remove add",function(e){return function(){return e.updateTotalPrice()}}(this)),this.serversView=new s({collection:this.serversCollection,el:"#servers",pricingMap:this.pricingMaps.forKey("server")})},initHyperscaleServers:function(){return this.hyperscaleServersCollection=new r,this.hyperscaleServersCollection.on("change remove add",function(e){return function(){return e.updateTotalPrice()}}(this)),this.hyperscaleServersView=new s({collection:this.hyperscaleServersCollection,el:"#hyperscale-servers",pricingMap:this.pricingMaps.forKey("server"),hyperscale:!0})},updateTotalPrice:function(){return this.initialized?(this.totalPrice=this.serversCollection.subtotal()+this.hyperscaleServersCollection.subtotal()+this.networkingServices.subtotal()+this.additionalServices.subtotal()+this.bandwidthServices.subtotal(),this.oSSubtotal=this.serversCollection.oSSubtotal()+this.hyperscaleServersCollection.oSSubtotal(),this.totalPriceWithSupport=this.totalPrice+this.supportView.updateSubtotal(),this.trigger("totalPriceUpdated")):void 0},setPricingMap:function(e){return this.pricingMaps=new a([],{datacenter:e}),this.pricingMaps.on("sync",function(e){return function(){return e.hyperscaleServersView.options.pricingMap=e.pricingMaps.forKey("server"),e.serversView.options.pricingMap=e.pricingMaps.forKey("server"),e.serversCollection.initPricing(e.pricingMaps),e.hyperscaleServersCollection.initPricing(e.pricingMaps),e.networkingServices.initPricing(e.pricingMaps),e.additionalServices.initPricing(e.pricingMaps),e.bandwidthServices.initPricing(e.pricingMaps)}}(this))}},$(function(){return t.init()})},{"./app/Config.coffee":1,"./app/Utils.coffee":2,"./app/collections/PricingMapsCollection.coffee":3,"./app/collections/ServersCollection.coffee":4,"./app/collections/ServicesCollection.coffee":5,"./app/models/ServiceModel.coffee":8,"./app/views/MonthlyTotalView.coffee":15,"./app/views/ServersView.coffee":17,"./app/views/ServicesView.coffee":19,"./app/views/SupportView.coffee":20}]},{},[21]);